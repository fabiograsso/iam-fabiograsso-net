<div id="ko-fi" style="display: flex; align-items: center; justify-content: center; text-align: center;">
  Do you like what you read? 
  <a href="https://ko-fi.com/O5O81JB4FK/tip" target="_blank">
    <img height='36'  class="no-zoom" style='border:0px;height:36px;margin:10px 0px 10px 10px;' src='/img/kofi5.webp' border='0' alt='Buy Me a Coffee at ko-fi.com' />
  </a>
</div>
<div id="comments">
  <!-- <h2>Comments</h2> -->
  <script src="https://giscus.app/client.js"
          data-repo="fabiograsso/iam-fabiograsso-net"
          data-repo-id="R_kgDOPXdHOg"
          data-category="Blog Comments"
          data-category-id="DIC_kwDOPXdHOs4Ct1ms"
          data-mapping="specific"
          data-term="{{ .Page.TranslationKey }}"
          data-strict="1"
          data-reactions-enabled="0"
          data-emit-metadata="1"
          data-input-position="top"
          data-theme="light"
          data-lang="en"
          async>
  </script>
</div>

<script>
function handleGiscusLoad(event) {
  //          data-loading="lazy"

  if (event.origin !== 'https://giscus.app') return;
  if (!(typeof event.data === 'object' && event.data.giscus)) return;

  const giscusData = event.data.giscus;
  
  console.log('Giscus is loaded!', giscusData);

  console.log('Giscus is loaded!');

  if ('discussion' in giscusData) {
    console.log('Giscus is loaded!', giscusData);
    yourCustomFunction();
  }
}

window.addEventListener('message', handleGiscusLoad);

function yourCustomFunction() {
  console.log('Giscus has finished loading!');
}


</script>
<script>
  function updateGiscusTheme() {
    function sendMessage(theme) {
      const iframe = document.querySelector('iframe.giscus-frame');
      if (iframe) {
        iframe.contentWindow.postMessage({ giscus: { setConfig: { theme: theme } } }, 'https://giscus.app');
      }
    }

    const isDarkMode = document.documentElement.classList.contains('dark');
    const giscusTheme = isDarkMode ? 'dark' : 'light';
    
    sendMessage(giscusTheme);

    const observer = new MutationObserver((mutations) => {
      mutations.forEach((mutation) => {
        if (mutation.attributeName === 'class') {
          const isDarkModeNow = document.documentElement.classList.contains('dark');
          const newGiscusTheme = isDarkModeNow ? 'dark' : 'light';
          sendMessage(newGiscusTheme);
        }
      });
    });

    observer.observe(document.documentElement, {
      attributes: true,
      attributeFilter: ['class']
    });
  }

  window.addEventListener('load', updateGiscusTheme);
</script>
